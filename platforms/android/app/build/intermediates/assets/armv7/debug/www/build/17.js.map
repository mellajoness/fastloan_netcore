{"version":3,"sources":["../../src/pages/signin/signin.module.ts","../../src/pages/signin/signin.ts"],"names":[],"mappings":"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","file":"17.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SigninPage } from './signin';\n\n@NgModule({\n  declarations: [\n    SigninPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SigninPage),\n  ],\n})\nexport class SigninPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signin/signin.module.ts","import { Component } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { IonicPage, MenuController, NavController, NavParams, ViewController, AlertController } from 'ionic-angular';\nimport { Storage } from '@ionic/storage';\nimport { FingerprintAIO } from '@ionic-native/fingerprint-aio';\nimport { Loader, Api, Session } from '../../providers';\nimport { Idle, WindowInterruptSource } from '@ng-idle/core';\nimport { Device } from '@ionic-native/device';\nimport { Platform } from 'ionic-angular';\n\n declare let Smartech:any;\n// import Smartech from 'smartech-cordova';\n/**\n * Generated class for the SigninPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-signin',\n  templateUrl: 'signin.html',\n})\nexport class SigninPage {\n  Smartech:any;\n  isReadyToProceed: boolean;\n  \n  form: FormGroup;\n\n  isFingerPrint: boolean;\n\n  sessionExpired: boolean = false;\n\n  hasFingerPrint: boolean = false;\n\n  //  appVersion: string = '0.0.6';  live\n   appVersion: string = '1';\n\n\n  constructor(private device: Device, public menu: MenuController, public alertCtrl: AlertController, public viewCtrl: ViewController, public idle: Idle, public storage: Storage, public session: Session, private faio: FingerprintAIO, public loading: Loader, public api: Api, formBuilder: FormBuilder, public navCtrl: NavController, public navParams: NavParams, public platform: Platform) {\n    this.form = formBuilder.group({\n      username: ['', Validators.compose([Validators.required, Validators.maxLength(11), Validators.minLength(11), Validators.pattern('[0-9]{11}')])],\n      password: ['', Validators.compose([Validators.required, Validators.minLength(8)])],\n      isFingerPrint: [false]\n    });\n\n    this.form.valueChanges.subscribe((v) => {\n      this.isReadyToProceed = this.form.valid;\n    });\n  }\n\n  ionViewDidLoad() {\n\n  }\n  ionViewWillEnter() {\n    this.menu.enable(false);\n    this.idle.stop();\n  }\n\n  ionViewWillLeave() {\n    this.menu.enable(true);\n    this.idle.watch();\n  }\n\n  ionViewDidEnter() {\n    this.sessionExpired = this.navParams.get('sessionExpired');\n    if ( this.sessionExpired ) {\n      console.log('Your session has expired');\n      this.session._getExpiredSessionMsg();\n    }\n    this.faio.isAvailable().then(result => {\n      result == 'finger' ? this.hasFingerPrint = true : console.log('device does not have finger print');\n    });\n    this.storage.get(\"usingBiometric\").then((res) => {\n      if(res) {\n          this.storage.get(\"phoneNumber\").then((PhoneNumber) => {\n            if(PhoneNumber) {\n              this.form.value.username = PhoneNumber;\n              this.storage.get(\"password\").then((password) => {\n                this.form.value.password = password;\n                this.showFingerprintAuthDlg();\n              })\n            }\n          })\n      }\n      return;\n    })\n  }\n\n    FingerPrintAuth() {\n    if(this.form.value.isFingerPrint) {\n      this.showFingerprintAuthDlg();\n    }\n    return;\n  }\n\n  showFingerprintAuthDlg(){\n    this.faio.show({\n      clientId: 'Fingerprint-Demo',\n      clientSecret: 'password', // Only Android\n      localizedFallbackTitle: 'Use Pin', // Only iOS\n      localizedReason: 'Please authenticate'\n    })\n          .then((result: any) => {\n            this.session._closeExpiredSessionMsg();\n            this.storage.set(\"usingBiometric\", true);\n            this.storage.set(\"phoneNumber\", this.form.value.username);\n            this.storage.set(\"password\", this.form.value.password);\n            this.doLogin();\n          })\n          .catch((error: any) => console.log(error));\n    /*this.fingerprintOptions = {\n        clientId: 'fingerprint-Demo',\n        clientSecret: 'password', //Only necessary for Android\n        disableBackup:true  //Only for Android(optional)\n    }*/\n\n  }\n\n  gotoLogin() {\n    this.navCtrl.push('LoginPage');\n  }\n\n doLogin() {\n    this.loading.show('Logging in...');\n    var req = {\n      password: this.form.value.password,\n      phoneNumber: this.session._injectCountryCode(this.form.value.username),\n      deviceId: '79b8f6b41479cde4',  \n      appVersion: this.appVersion,\n      // deviceId: 'df1284ucnod',\n\n      \n      //deviceId: this.device.uuid,\n\n     \n\n      // deviceId: 'df1284ucnod' //is a hard coded device id\n\n     \n\n     //deviceId: 'a39fd1e4153d329a' //is a hard coded device id\n    };     \nconsole.log('Body', req);\n    this.api.postLogin('login-controller/login', req).subscribe((res:any) => {\n      console.log('Login Response', res);\n      this.loading.hide();\n      if(res.code == '00') {\n        this.session._setPhoneNumber(res.data.phoneNumber);\n        this.session._setSessionKey(res.data.sessionKey);\n        this.session._setEmail(res.data.emailAddress);\n        this.session._setFirstname(res.data.firstName);\n        this.session._setLastname(res.data.lastName);\n         this.session._setCustID(res.data.customerId)\n\n       let email= this.session._getEmail();\n       let custId= this.session._getCustID();\n       console.log('my email is', email)\n       console.log('my cust id', custId)\n\n       const payloadata = {\n        CUSTOMER_ID :custId,\n        EMAIL:email \n      \n      };\n        Smartech.setIdentity(payloadata.CUSTOMER_ID);\n        Smartech.login(payloadata.CUSTOMER_ID);\n        console.log(\"Login successful\")\n        Smartech.track(\"USER_LOGIN\", payloadata);\n        \n\n\n        this.navCtrl.setRoot('DashboardPage');\n      }\n       else if(res.code == '012' && this.platform.is('android')){\n        const alert = this.alertCtrl.create({\n          title: '<strong>Update Required!</strong>',\n          message: res.message,\n          buttons: [\n            {\n              text: 'Update',\n              handler: () => {\n                window.open('https://play.google.com/store/apps/details?id=io.fidelity.flashlend', '_system')\n                console.log('Confirm Okay');\n              }\n            }\n          ]\n        });\n        alert.present();\n      } else if (res.code == '012' && this.platform.is('ios')){\n        const alert = this.alertCtrl.create({\n          title: '<strong>Update Required!</strong>',\n          message: res.message,\n          buttons: [\n             {\n              text: 'Update',\n              handler: () => {\n                // window.open('https://google.com.ng', '_system')\n                console.log('Confirm Okay');\n              }\n            }\n          ]\n        });\n        alert.present();\n      }\n      else {\n        this.api.messageHandler(res.message, 5000, 'top');\n      }\n    }, (error:any) => {\n      this.loading.hide();\n      this.api.messageHandler(error.error.message, 5000, 'top');\n    })\n  }\n\n  gotoChangeDevice() {\n    this.navCtrl.push('ChangedevicePage');\n  }\n\n  gotoForgotpassword () {\n    this.navCtrl.push('ForgetpasswordPage');\n  }\n\n  // navigate(){\n  //   this.navCtrl.push('NewregPage');\n  // }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signin/signin.ts"],"sourceRoot":""}