{"version":3,"sources":["../../src/pages/forgetpassword/forgetpassword.module.ts","../../src/pages/forgetpassword/forgetpassword.ts"],"names":[],"mappings":"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","file":"34.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ForgetpasswordPage } from './forgetpassword';\n\n@NgModule({\n  declarations: [\n    ForgetpasswordPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ForgetpasswordPage),\n  ],\n})\nexport class ForgetpasswordPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/forgetpassword/forgetpassword.module.ts","import { Component } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Loader, Api, Session } from '../../providers';\nimport { Idle } from '@ng-idle/core';\nimport { Device } from '@ionic-native/device';\ndeclare let Smartech:any;\n/**\n * Generated class for the ForgetpasswordPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-forgetpassword',\n  templateUrl: 'forgetpassword.html',\n})\nexport class ForgetpasswordPage {\n\n  isReadyToProceed: boolean;\n\n  form: FormGroup;\n\n  phoneNumber: string;\n\n  // additon starts\n\n  hintStyle: string;\n\n  // additon close\n\n  question: string;\n\n  isBusy: boolean = false;\n\n  hasQuestion: boolean = false;\n\n  // additon starts\n  hasHint: boolean = false;\n\n  // additon close\n\n  secretQuestionTryCount : number = 0;\n\n  constructor(private device: Device, public idle: Idle, public loading: Loader, public api: Api, public session: Session, formBuilder: FormBuilder, public navCtrl: NavController, public navParams: NavParams) {\n\n    this.form = formBuilder.group({\n      answer: ['', Validators.compose([Validators.required])],\n      phoneNumber: ['', Validators.compose([Validators.required, Validators.maxLength(11), Validators.minLength(11), Validators.pattern('[0-9]{11}')])],\n      newPassword: ['', Validators.compose([Validators.required, Validators.minLength(8), Validators.pattern('^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-.,]).{8,}$')])],\n      confirmPassword: ['', Validators.compose([Validators.required, Validators.minLength(8), Validators.pattern('^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-.,]).{8,}$')])],\n    });\n\n    this.form.valueChanges.subscribe((v) => {\n      this.isReadyToProceed = this.form.valid;\n    });\n  }\n\n  ionViewWillEnter() {\n    this.idle.stop();\n  }\n\n  ionViewWillLeave() {\n    this.idle.watch();\n  }\n  getSecretQuestion() {\n\n    // this.secretQuestionTryCount++;\n      this.isBusy = true;\n      var req =  {\n        //deviceId: this.device.uuid,\n        deviceId: '79b8f6b41479cde4',\n        phoneNumber: this.session._injectCountryCode(this.form.value.phoneNumber)\n      }\n      console.log('Forgot Password Body', req)\n      this.api.post('login-controller/forget-password', req).subscribe((res: any) => {\n        console.log('Forgot Response', res);\n        this.isBusy = false;\n\n        if(res.code == '00') {\n          this.question = res.data.secretQuestion;\n          this.hasQuestion = true;\n        \n          return;\n        }\n\n        this.api.messageHandler(res.message, 5000, 'top');\n      \n        //I did this for the purpose of Hint\n\n        // if(res.code == '99') {\n        //   this.question = res.data.secretQuestion;\n        //   this.hasQuestion = true;\n        // } else if(res.code == '88'){\n        //   this.hintStyle = res.data.hint\n        //   this.hasHint = true;\n        // } else if(res.code !== '99' && res.code !=='88'){\n        //   this.api.messageHandler(res.message, 5000, 'top');\n        // } else {\n        //   return;\n        // }\n\n      }, (error) => {\n        console.log(error);\n        this.isBusy = false;\n        this.api.messageHandler(error.error.message);\n      })\n  }\n\n  press(val) {\n    if(val.length == 11) {\n      this.getSecretQuestion();\n    }\n  }\n\n  submit () {\n    this.loading.show('Reseting your password...');\n    var req = {\n      confirmPassword: this.form.value.confirmPassword,\n      password: this.form.value.newPassword,\n      phoneNumber: this.session._injectCountryCode(this.form.value.phoneNumber),\n      secretAnswer: this.form.value.answer,\n      //deviceId: this.device.uuid\n      deviceId: '79b8f6b41479cde4'\n    };\n    console.log('Reset Body', req);\n    this.api.post('login-controller/reset-password', req).subscribe((res: any) => {\n      console.log('Reset Password Response', res);\n      this.api.messageHandler(res.message);\n      if(res.code == '00') {\n        \n        let email= this.session._getEmail();\n        let custId= this.session._getCustID();\n        console.log('my email is', email)\n        console.log('my cust id', custId)\n        const payload = {\n          CUSTOMER_ID :custId,\n          EMAIL:email \n        }\n        Smartech.setIdentity(payload.CUSTOMER_ID);\n        Smartech.track(\"FORGET_PASSWORD_SUCCESSFUL\",payload);\n        this.navCtrl.push('SigninPage');\n      }\n      else{\n        this.api.messageHandler(res.message);\n\n        let email= this.session._getEmail();\n        let custId= this.session._getCustID();\n        console.log('my email is', email)\n        console.log('my cust id', custId)\n        const payload = {\n          CUSTOMER_ID :custId,\n          EMAIL:email \n        }\n        Smartech.setIdentity(payload.CUSTOMER_ID);\n        Smartech.track(\"FORGET_PASSWORD_STEP_1_FAILED\",payload);\n\n\n      }\n    }, (error: any) => {\n      this.api.messageHandler(\"An error occured, please try again\");\n    }, () => {\n      this.loading.hide();\n    })\n  }\n\n  gotoLogin() {\n    this.navCtrl.push('SigninPage');\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/forgetpassword/forgetpassword.ts"],"sourceRoot":""}